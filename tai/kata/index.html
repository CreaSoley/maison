<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>PrÃ©paration 2Ã¨me Dan â€“ Kata</title>

  <!-- Material Icons + Police Spicy -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  
  <!-- IMPORTANT : Ajout de la bibliothÃ¨que PapaParse -->
  <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>

  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="../banner.css">
</head>

<body data-title="Kata â€“ EntraÃ®nement">

  <!-- HEADER -->
  <<div id="bannerContainer"></div>

<script>
fetch("../banner.html")
  .then(r => r.text())
  .then(html => {
    document.getElementById("bannerContainer").innerHTML = html;

    // 1) prioritÃ© : data-title sur <body>
    let pageTitle =
      document.body.dataset.title ||
      document.querySelector("h1")?.textContent ||
      document.querySelector("title")?.textContent ||
      "";

    const target = document.querySelector(".header-text .title");
    if (target && pageTitle) {
      target.textContent = pageTitle;
    }
  });
</script>

<!-- CONTENU -->
<main class="kata-container">
  <div class="main-content-container">

    <!-- ENCART 1 : vidÃ©o -->
    <section class="kata-block block-video">
      <h2 class="spicy section-title">ğŸ¥ Kata en vidÃ©o</h2>
      <iframe class="video-frame"
        src="https://www.youtube.com/embed/5MZsQbEMF6c"
        frameborder="0"
        allowfullscreen></iframe>
    </section>

    <!-- ENCART 2 : GIF -->
    <section class="kata-block block-gif">
      <h2 class="spicy section-title">ğŸ¬ DÃ©mo animÃ©e</h2>
      <img class="gif-frame" src="kata2.gif" alt="DÃ©mo Kata">
    </section>

    <!-- ENCART 3 : Zone d'entraÃ®nement -->
    <section class="kata-block block-training">
      <h2 class="spicy section-title">ğŸ² Zone d'entraÃ®nement</h2>

      <button id="btnKataRandom" class="btn primary kawaii">
        ğŸ² Nouveau tirage
      </button>

      <p style="margin-top:10px;font-size:1.2rem;">
        Kata sÃ©lectionnÃ© : <span id="kataResult">-</span>
      </p>

      <!-- MÃ©tronome -->
      <div id="metronome">
        <div class="lcd-display" id="lcdDisplay">120 | 1</div>

        <div class="tempo-control">
          <label for="bpmSlider">
            Tempo (BPM) : <span id="bpmValue">120</span>
          </label>
          <input type="range" id="bpmSlider" min="40" max="220" value="120">
        </div>

        <div class="metronome-controls">
          <button id="playBtn" class="metronome-btn play">
            <span class="material-icons">play_arrow</span>
          </button>
          <button id="stopBtn" class="metronome-btn stop">
            <span class="material-icons">stop</span>
          </button>
        </div>

        <div class="pattern-grid" id="patternGrid"></div>
      </div>
    </section>

    <!-- ENCART 4 : Fiches -->
    <section class="kata-block block-fiches">
      <h2 class="spicy section-title">ğŸ“ Mes fiches de suivi</h2>

      <div class="fiche-header">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSefEKw3CssjHA6MLv4Uq_6hImqztUgLmpnDrHOn0gQBDw8dEw/viewform?usp=header"
          target="_blank"
          class="btn primary kawaii">
          <span class="material-icons">add_circle</span>
          Ajouter un kata
        </a>

        <div class="selector-container">
          <label for="kataSelector">
            Choisir une fiche Ã  consulter :
          </label>
          <select id="kataSelector" class="kata-selector">
            <option value="">-- Chargement en cours... --</option>
          </select>
        </div>
      </div>

      <div id="kataCardDisplay"></div>
    </section>

  </div>
</main>


<!-- ... (la fin de votre fichier avec les scripts est inchangÃ©e) ... -->

  <!-- ====================================================== -->
  <!-- SCRIPTS : PLACÃ‰S Ã€ LA FIN DU BODY -->
  <!-- ====================================================== -->
  <!-- Script pour la zone d'entraÃ®nement -->
  <script src="script.js"></script>
  <!-- NOUVEAU script pour la gestion des fiches -->
  <script src="fiche-manager.js"></script>

</body>
</html>
