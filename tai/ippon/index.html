<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ippon Kumite ‚Äì Tai Jitsu</title>

  <!-- CSS principal -->
  <link rel="stylesheet" href="style-ippon.css">
  <link rel="stylesheet" href="banner.css">

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Polices locales -->
  <style>
    @font-face {
      font-family: "Spicy";
      src: url("Spicy Sale.ttf") format("truetype");
    }
    @font-face {
      font-family: "Shangha√Ø";
      src: url("shanghai.ttf") format("truetype");
    }
    @font-face {
      font-family: "Fredoka";
      src: url("Fredoka.ttf") format("truetype");
    }

    .spicy { font-family: "Spicy", cursive; }
    .shanghai { font-family: "Shangha√Ø", cursive; }
    .fredoka { font-family: "Fredoka", Arial, sans-serif; }

    /* Layout 2 colonnes desktop, 1 colonne mobile */
    .layout-4cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      width: 100%;
      padding: 20px;
      box-sizing: border-box;
    }

    .card-block {
      background: #f7f7f7;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    }

    .card-block h2 {
      margin-top: 0;
      margin-bottom: 10px;
    }

    .controls {
      margin-bottom: 10px;
    }

    .accordion-item {
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
    }

    .accordion-header {
      background: #ddd;
      padding: 10px;
      cursor: pointer;
      font-weight: bold;
    }

    .accordion-content {
      display: none;
      padding: 10px;
      background: #fff;
    }

    img.fiche-img {
      width: 100%;
      max-width: 400px;
      display: block;
      margin: 0 auto;
    }

    /* Styles entrainement */
    #trainingControls {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    #trainingControls input[type=range] {
      width: 100%;
    }

    #trainingOutput {
      margin-top: 15px;
      font-size: 1.2rem;
      text-align: center;
      min-height: 2em;
    }
  </style>
</head>

<body data-title="Ippon kumite ‚Äì Entra√Ænement">

  <!-- BANNI√àRE -->
  <div id="bannerContainer"></div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      fetch("banner.html")
        .then(r => r.text())
        .then(html => {
          document.getElementById("bannerContainer").innerHTML = html;
          let pageTitle =
            document.body.dataset.title ||
            document.querySelector("h1")?.textContent ||
            document.querySelector("title")?.textContent || "";
          const target = document.querySelector(".header-text .title");
          if (target && pageTitle) target.textContent = pageTitle;
        })
        .catch(err => console.error("Erreur chargement banni√®re :", err));
    });
  </script>

  <!-- 4 ENCARTS -->
  <main class="layout-4cards">

    <!-- ENCADR√â 1 : Techniques par c√¥t√© -->
    <section class="card-block" id="script1">
      <h2 class="spicy section-title">ü•ã Techniques par c√¥t√©</h2>
      <div class="controls controls-column">
        <select id="selectSerieAccordion">
          <option value="">Choisir une s√©rie</option>
        </select>
        <select id="filterSideAccordion">
          <option value="">Choisir un c√¥t√©</option>
          <option value="droite">Droite</option>
          <option value="gauche">Gauche</option>
        </select>
      </div>
      <div id="accordionList"></div>
    </section>

    <!-- ENCADR√â 2 : Fiche technique -->
    <section class="card-block" id="script2">
      <h2 class="spicy section-title">üí´ Fiche technique</h2>
      <div class="controls controls-column">
        <select id="selectSerie">
          <option value="">Choisir une s√©rie</option>
        </select>
        <select id="selectAttack">
          <option value="">Choisir une attaque</option>
        </select>
        <select id="selectSide">
          <option value="">Choisir un c√¥t√©</option>
          <option value="droite">Droite</option>
          <option value="gauche">Gauche</option>
        </select>
      </div>
      <div id="resultCard"></div>
    </section>

    <!-- ENCADR√â 3 : Fiches de travail en PNG -->
    <section class="card-block" id="script3">
      <h2 class="spicy section-title">üñºÔ∏è Fiches de travail</h2>
      <div class="controls">
        <select id="filterSidePng">
          <option value="">Choisir un c√¥t√©</option>
          <option value="droite">Droite</option>
          <option value="gauche">Gauche</option>
        </select>
      </div>
      <div id="accordionPng"></div>
    </section>

    <!-- ENCADR√â 4 : Entra√Ænement al√©atoire -->
    <section class="card-block" id="script4">
      <h2 class="spicy section-title">‚ö° Entra√Ænement vocal al√©atoire</h2>
      <div id="trainingControls">
        <button id="startTraining">D√©marrer l'entra√Ænement</button>
        <button id="stopTraining">Arr√™ter</button>
        <label>Intervalle entre techniques : <span id="intervalValue">5</span> secondes</label>
        <input type="range" id="intervalRange" min="3" max="60" value="5">
      </div>
      <div id="trainingOutput"></div>
    </section>

  </main>

  <script>
    // --- ENCADR√â 3 : Accord√©on PNG ---
    const fiches = [
      { name: "O√è tsuki jodan", file: "otjd.png", side: "droite" },
      { name: "O√è tsuki chudan", file: "otjc.png", side: "gauche" },
      { name: "Mae geri", file: "maegeri.png", side: "droite" },
      // Ajouter jusqu'√† 10 techniques
    ];

    function buildAccordionPng(sideFilter = "") {
      const container = document.getElementById("accordionPng");
      container.innerHTML = "";
      const filtered = fiches.filter(f => !sideFilter || f.side === sideFilter);
      filtered.forEach(f => {
        const item = document.createElement("div");
        item.className = "accordion-item";
        const header = document.createElement("div");
        header.className = "accordion-header";
        header.textContent = f.name;
        const content = document.createElement("div");
        content.className = "accordion-content";
        const img = document.createElement("img");
        img.src = f.file;
        img.className = "fiche-img";
        content.appendChild(img);
        header.addEventListener("click", () => {
          content.style.display = content.style.display === "block" ? "none" : "block";
        });
        item.appendChild(header);
        item.appendChild(content);
        container.appendChild(item);
      });
    }

    document.getElementById("filterSidePng").addEventListener("change", (e) => {
      buildAccordionPng(e.target.value);
    });

    buildAccordionPng();

    // --- ENCADR√â 4 : Entra√Ænement vocal al√©atoire ---
    const techniques = [
      "O√è tsuki jodan", "O√è tsuki chudan", "Mae geri", 
      "Yoko geri", "Gyaku tsuki", "Kizami tsuki", 
      "Ura mawashi geri", "Soto uke", "Uchi uke", "Shuto uke"
    ];
    let trainingInterval, synth = window.speechSynthesis;

    const intervalRange = document.getElementById("intervalRange");
    const intervalValue = document.getElementById("intervalValue");
    intervalRange.addEventListener("input", () => intervalValue.textContent = intervalRange.value);

    document.getElementById("startTraining").addEventListener("click", () => {
      document.getElementById("trainingOutput").textContent = "Pr√©paration... 5 secondes";
      setTimeout(() => {
        trainingInterval = setInterval(() => {
          const t = techniques[Math.floor(Math.random() * techniques.length)];
          document.getElementById("trainingOutput").textContent = t;
          const utter = new SpeechSynthesisUtterance(t);
          utter.lang = "fr-FR";
          synth.speak(utter);
        }, intervalRange.value * 1000);
      }, 5000);
    });

    document.getElementById("stopTraining").addEventListener("click", () => {
      clearInterval(trainingInterval);
      document.getElementById("trainingOutput").textContent = "Entra√Ænement arr√™t√©";
    });
  </script>

</body>
</html>
